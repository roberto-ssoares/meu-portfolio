<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>BA-DS-ML-Retail-Area</title>
<!-- MathJax Configuração -->
<script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true
        }
      });
    </script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<!-- Adicionando o Highlight.js para sintaxe de código -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<style>
        /* Estilo básico para o notebook exportado */
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }

        h1, h2, h3 {
            color: #333;
        }

        .output {
            background-color: #ECECEC;
            border-left: 5px solid #ccc;
            padding: 10px;
            margin: 2px 0;
            color: #171c81; /* Cor do texto do código */
            font-size: 20px; /* Diminui o tamanho da fonte */
        }

        .code_cell {
            background-color: #fdf0f0; /* Fundo cinza claro */
            border: 2px solid #e0e0e0; /* Borda clara */
            padding: 10px;
            margin: 10px 0;
            color: #333333; /* Cor do texto do código */
            font-size: 14px; /* Tamanho da fonte aumentado */
            line-height: 1.4; /* Espaçamento entre linhas aumentado */            
        }

        pre {
            background-color: #f7f7f7; /* Fundo cinza claro */
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            margin: 10px 0; /* Remove margens adicionais */        
        }

        /* Adicionando estilo de Highlight.js ao código */
        .code_cell pre code {
            background-color: #f5f2f0; /* Fundo similar ao Jupyter */
            color: #000; /* Texto preto */
            font-family: 'Courier New', Courier New, monospace; /* Estilo de fonte monoespaçada */
        }

        .output_png img {
            width: 95%; /* Faz com que a imagem ocupe 90% da largura da célula */
            max-width: 1000px; /* Limita a largura máxima da imagem a 1200 pixels */
            height: 95%; /* Mantém a proporção original da imagem */
            text-align: center;
        }

        .cell {
            margin-bottom: 20px;
            color: #171c81; /* Cor do texto do código */
        }

        .anchor-link {
            display: none; /* Remover a exibição do símbolo ¶ */
        }

        .scrollable-output {
            max-height: 100%; /* Define a altura máxima antes de ativar o scroll */
            max-width: 100%; /* Ajusta a largura ao tamanho da tela */
            overflow-x: auto; /* Habilita o scroll horizontal */
            border: 1px solid #ccc; /* Adiciona uma borda ao contêiner */
            padding: 10px;
            background-color: #fff; /* Cor de fundo para contraste */
        }

        h1 {
            font-size: 20px; /* Diminui o tamanho da fonte */
            font-family: 'Segoe Print', Segoe, Print; /* Altera a fonte para Times New Roman */
            color: #686f87; /* Cor opcional */
        }
    </style>
</head>
<body>
<h1>BA-DS-ML-Retail-Area</h1>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<h1 id=""><a class="anchor-link" href="#">¶</a></h1><p style="text-align: center;">
<font color="#0A1781" face="Segoe Script" size="6">
<strong>
        Business Analytics &amp; Machine Learning
    </strong>
</font>
</p>
<p style="text-align: center;">
<font color="#C58A1E" face="Segoe Script" size="6.5">
<strong>Business Analysis, Data Science and<br/>Machine Learning in the Retail Sector
</strong></font>
</p>
<h1 id=""><a class="anchor-link" href="#">¶</a></h1></div>
</div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F4F4F4">
<p style="text-align: right;">
<font color="#444444" face="Segoe Script" size="4">
    Roberto Soares - LfLngLrnng
  </font>
</p>
<p style="text-align: right;"><font color="#444444" face="Segoe Print" size="2">
<a href="https://www.linkedin.com/in/roberto-dos-santos-soares/">in/roberto-dos-santos-soares</a>
<p style="text-align: right;"><font color="#444444" face="Segoe Print" size="2">
<a href="https://github.com/roberto-ssoares/meu-portfolio.github.io">Portifólio: roberto-ssoares-meu-portfolio</a>
<p style="text-align: right;">
<font color="#444444" face="Segoe Script" size="3">
    [+] Faturamento,<br \=""/> [-] Custo,<br \=""/> [+] Qualidade de vida  
  </font>
</p>
</font></p></font></p></div>
</div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<p style="text-align: left;">
<font color="#0A1781" face="Segoe Script" size="5">
<strong>
        Projeto - IA (LLMs) para Previsão de Demanda e Otimização do Estoque de Produtos Sazonais
    </strong>
</font>
</p>
</div>
</div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<h2 id="Produtos-sazonais"><font color="#CC403E" face="Segoe Print" size="4"><strong>Produtos sazonais</strong></font><a class="anchor-link" href="#Produtos-sazonais">¶</a></h2><font color="#66666" face="Segoe Print" size="3">
<ul>
<li>Bens ou serviços cuja demanda varia significativamente ao longo do ano, dependendo de fatores como estações do ano, feriados, eventos específicos ou tendências periódicas.</li>
<li>Esses produtos geralmente estão associados a épocas ou períodos específicos e têm maior procura em determinados momentos, enquanto sua demanda diminui ou se torna inexistente fora desses períodos.</li>
</ul>
<p><strong>Exemplos de produtos sazonais:</strong></p>
<ul>
<li><strong>Roupas de inverno</strong>: Casacos e luvas têm maior demanda em climas frios ou durante o inverno.</li>
<li><strong>Artigos de verão</strong>: Roupas de banho, ventiladores e protetores solares são mais procurados no verão.</li>
<li><strong>Produtos alimentícios temáticos</strong>: Panetones no Natal, ovos de chocolate na Páscoa ou comidas típicas de festas juninas.</li>
<li><strong>Itens relacionados a eventos específicos</strong>: Decorações para Halloween ou produtos ligados a eventos esportivos, como copos temáticos para a Copa do Mundo.</li>
</ul>
<p><strong>Características principais:</strong></p>
<ol>
<li><strong>Demanda periódica</strong>: A procura ocorre em ciclos ou períodos específicos.</li>
<li><strong>Planejamento necessário</strong>: Empresas precisam se antecipar, ajustando estoques, marketing e produção conforme a sazonalidade.</li>
<li><strong>Impacto no preço</strong>: Em períodos de alta demanda, os preços podem subir, enquanto fora de temporada, podem ocorrer descontos ou promoções.</li>
</ol>
<p>Gerenciar produtos sazonais de forma eficiente exige uma boa compreensão dos padrões de consumo e estratégias para evitar excesso de estoque ou falta de produtos durante os períodos de maior procura.</p>
</font></div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<h2 id="CRISP-DM-%5BBusiness-Understanding%5D"><font color="#CC403E" face="Segoe Print" size="5"><strong>CRISP-DM [Business Understanding]</strong></font><a class="anchor-link" href="#CRISP-DM-%5BBusiness-Understanding%5D">¶</a></h2><font color="#66666" face="Segoe Print" size="3">
<p><strong>1. Objetivo Principal</strong></p>
<ul>
<li>Desenvolver uma solução baseada em Inteligência Artificial (IA) que integre Modelos de Linguagem de Grande Escala (LLMs) e análise de dados estruturados para prever demandas e otimizar estoques de produtos sazonais, promovendo eficiência operacional e reduzindo desperdícios.</li>
</ul>
<p><strong>2. Questões de Negócio</strong></p>
<ol>
<li><strong>Previsão de demanda</strong>:<ul>
<li>Quais produtos sazonais terão maior ou menor demanda nos próximos períodos?</li>
<li>Como podemos prever as variações sazonais com maior precisão, minimizando falhas na disponibilidade de produtos?</li>
</ul>
</li>
<li><strong>Otimização de Estoques</strong>:<ul>
<li>Qual é a quantidade ideal de estoque para cada produto em períodos de alta e baixa sazonalidade?</li>
<li>Como balancear o custo de manter estoque (overstock) com o risco de perda de vendas por falta de produtos (stockout)?</li>
</ul>
</li>
<li><strong>Eficiência Operacional</strong>:<ul>
<li>Quais insights podem ser extraídos para ajudar na logística, reposição e alocação de produtos entre unidades ou regiões?</li>
</ul>
</li>
</ol>
<p><strong>3. Objetivos de Negócio</strong></p>
<ol>
<li><strong>Reduzir custos</strong>: Minimizar desperdícios de estoque e evitar custos excessivos de armazenamento.</li>
<li><strong>Aumentar a receita</strong>: Melhorar a disponibilidade de produtos em períodos de alta demanda para maximizar vendas.</li>
<li><strong>Melhorar a satisfação do cliente</strong>: Garantir que produtos estejam disponíveis no momento certo e na quantidade certa.</li>
<li><strong>Apoiar decisões estratégicas</strong>: Fornecer insights baseados em dados e IA para ajudar equipes de vendas, marketing e logística a planejar campanhas e operações.</li>
</ol>
<p><strong>4. Relevância para o Negócio</strong></p>
<ul>
<li>Produtos sazonais têm impacto significativo nos lucros de empresas que lidam com varejo, moda, alimentos e bens de consumo.</li>
<li>Estimar a demanda com precisão pode evitar perdas financeiras significativas por excesso ou falta de estoque.</li>
<li>Uma abordagem baseada em dados estruturados e IA pode melhorar a competitividade da empresa em mercados dinâmicos.</li>
</ul>
<p><strong>5. Limitações do Projeto</strong></p>
<ul>
<li><strong>Dados fictícios</strong>: Apesar de permitir um controle maior, pode não refletir perfeitamente as nuances e complexidades de dados reais.</li>
<li><strong>Dependência de LLMs</strong>: Modelos de linguagem podem exigir ajustes para trabalhar com informações específicas do domínio.</li>
</ul>
<p><strong>6. Indicadores de Sucesso (KPIs)</strong></p>
<ol>
<li><strong>Precisão da previsão de demanda</strong>: Percentual de acertos em relação à demanda real de produtos.</li>
<li><strong>Redução de custos de estoque</strong>: Comparação dos custos antes e após a implementação do projeto.</li>
<li><strong>Redução do índice de stockouts</strong>: Percentual de produtos em falta durante períodos de alta demanda.</li>
<li><strong>Aumento da eficiência operacional</strong>: Redução de desperdícios e melhor balanceamento de estoques.</li>
<li><strong>Melhoria na satisfação do cliente</strong>: Medido por indicadores como Net Promoter Score (NPS) ou taxas de reclamação.</li>
</ol>
<p><strong>7. Contexto de Mercado e Insights</strong></p>
<ol>
<li><strong>Tendências tecnológicas</strong>:<ul>
<li>O uso de LLMs em previsão de demanda é uma inovação crescente no mercado, capaz de considerar variáveis complexas como notícias, clima e comportamento do consumidor.</li>
</ul>
</li>
<li><strong>Cenário competitivo</strong>:<ul>
<li>Empresas que utilizam IA para gerenciar estoques tendem a ter vantagem competitiva devido à maior eficiência e flexibilidade operacional.</li>
</ul>
</li>
<li><strong>Ciclo de vida do produto</strong>:<ul>
<li>É essencial considerar o estágio de cada produto (lançamento, crescimento, maturidade ou declínio) no modelo de previsão e otimização.</li>
</ul>
</li>
</ol>
<p><strong>8. Soluções Complementares</strong></p>
<ul>
<li><strong>Integração de Dados</strong>:<ul>
<li>Utilizar SQL para consolidar informações de diferentes fontes (transações, histórico de vendas, clima, eventos) em uma base única para análise.</li>
</ul>
</li>
<li><strong>Modelagem Sazonal</strong>:<ul>
<li>Implementar técnicas específicas, como decomposição de séries temporais e algoritmos de aprendizado supervisionado, para identificar padrões sazonais.</li>
</ul>
</li>
<li><strong>Simulações Operacionais</strong>:<ul>
<li>Realizar simulações baseadas em cenários hipotéticos para validar a robustez do modelo e preparar estratégias para variações inesperadas.</li>
</ul>
</li>
</ul>
</font></div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<h2 id="Estrat%C3%A9gia-e-Abordagem"><font color="#CC403E" face="Segoe Print" size="4"><strong>Estratégia e Abordagem</strong></font><a class="anchor-link" href="#Estrat%C3%A9gia-e-Abordagem">¶</a></h2><font color="#66666" face="Segoe Print" size="3">
<p><strong>Projeto típico de uma empresa de varejo: Previsão de demanda e otimização de estoque</strong></p>
<p><strong>Descrição do Problema</strong></p>
<ul>
<li>A empresa enfrenta dificuldades em gerenciar o estoque de produtos sazonais, cuja demanda é irregular ao longo do ano.</li>
<li>Essa imprevisibilidade pode levar tanto a faltas no estoque quanto a excesso de produtos armazenados, resultando em perdas financeiras.</li>
</ul>
<p><strong>Estratégia Inicial - Abordagem Tradicional</strong><br>
O problema pode ser dividido em dois subprojetos, com base no framework CRISP-DM:</br></p>
<ol>
<li><p><strong>Previsão de Demanda:</strong></p>
<ul>
<li><strong>Passos:</strong><ul>
<li>Coletar e preparar dados históricos de vendas, estoques e sazonalidades.</li>
<li>Treinar um modelo de machine learning adequado para prever a demanda futura com base nos padrões históricos.</li>
</ul>
</li>
<li><strong>Exemplo de Algoritmos:</strong><ul>
<li>Modelos de regressão (Linear, Ridge, etc.).</li>
<li>Modelos baseados em séries temporais (ARIMA, Prophet).</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Otimização de Estoque:</strong></p>
<ul>
<li><strong>Passos:</strong><ul>
<li>Utilizar os resultados da previsão de demanda como insumos para algoritmos de otimização.</li>
<li>Implementar estratégias que minimizem custos relacionados ao excesso ou falta de estoque.</li>
</ul>
</li>
<li><strong>Exemplo de Algoritmos:</strong><ul>
<li>Algoritmos heurísticos (como otimização por enxame de partículas ou algoritmos genéticos).</li>
<li>Programação linear ou não linear para calcular o nível ótimo de estoque.</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>Limitações da Abordagem Tradicional</strong></p>
<ul>
<li><strong>Tempo elevado:</strong> A implementação e ajuste desses modelos demandam recursos e tempo.</li>
<li><strong>Falta de flexibilidade:</strong> Estratégias tradicionais muitas vezes não conseguem capturar nuances complexas, como mudanças abruptas na demanda.</li>
</ul>
<p><strong>Abordagem Avançada - Utilizando LLMs (Large Language Models)</strong><br>
Com os avanços em inteligência artificial, modelos de linguagem como GPT podem ser usados para substituir ou complementar abordagens tradicionais.</br></p>
<ol>
<li><p><strong>Entrada de Dados no LLM:</strong></p>
<ul>
<li>Coletar dados históricos de vendas, estoque, produtos e sazonalidades diretamente do banco de dados da empresa.</li>
<li>Estruturar esses dados no formato de texto ou tabelas para alimentar o modelo LLM.</li>
</ul>
</li>
<li><p><strong>Processamento pelo LLM:</strong></p>
<ul>
<li>Os LLMs são capazes de compreender texto natural, identificar padrões e gerar previsões coerentes com alta eficiência.</li>
<li>A saída gerada pode incluir:<ul>
<li>Previsão de demanda para períodos futuros.</li>
<li>Sugestões de otimização do estoque com base em análises contextualizadas.</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Resultados Esperados:</strong></p>
<ul>
<li><strong>Eficiência operacional:</strong> Previsões mais precisas e em menos tempo.</li>
<li><strong>Insights acionáveis:</strong> O modelo não apenas prevê demandas, mas também pode sugerir estratégias detalhadas para armazenamento e reposição.</li>
<li><strong>Flexibilidade:</strong> Capacidade de adaptar-se rapidamente a mudanças nos padrões de consumo.</li>
</ul>
</li>
</ol>
<p><strong>Vantagens da Nova Abordagem</strong></p>
<ul>
<li><strong>Velocidade:</strong> Processamento significativamente mais rápido em relação aos métodos tradicionais.</li>
<li><strong>Precisão:</strong> LLMs conseguem incorporar contextos complexos e gerar previsões mais detalhadas.</li>
<li><strong>Simplicidade:</strong> Reduz a necessidade de configurações manuais detalhadas, como ajuste de hiperparâmetros.</li>
</ul>
<p><strong>Considerações Finais</strong></p>
<ul>
<li><strong>Substituir a abordagem tradicional pela avançada, baseada em LLMs, não significa descartar totalmente métodos clássicos, mas sim complementá-los.</strong></li>
<li><strong>O uso integrado de machine learning estruturado e LLMs pode maximizar os resultados, oferecendo uma solução mais robusta, rápida e alinhada<br/>com as necessidades de empresas varejistas que lidam com sazonalidades complexas.</strong></li>
</ul>
</font></div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<h2 id="CRISP-DM-%5BData-Understanding%5D"><font color="#CC403E" face="Segoe Print" size="5"><strong>CRISP-DM [Data Understanding]</strong></font><a class="anchor-link" href="#CRISP-DM-%5BData-Understanding%5D">¶</a></h2><font color="#66666" face="Segoe Print" size="3">
</font></div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<h2 id="Script-02-CriaTabelas.py"><font color="#CC403E" face="Segoe Print" size="4"><strong>Script 02-CriaTabelas.py</strong></font><a class="anchor-link" href="#Script-02-CriaTabelas.py">¶</a></h2><font color="#66666" face="Segoe Print" size="2">
<p>Python - Pipeline de Criação do Banco de Dados</p>
<p><strong>Descrição do objetivo deste script:</strong></p>
<ul>
<li>Automatizar a execução de um script SQL armazenado em um arquivo externo para<br/>criar e configurar tabelas dentro de um banco de dados PostgreSQL.</li>
</ul>
<p><strong>Ações realizadas no script:</strong></p>
<ol>
<li>Carrega variáveis de ambiente a partir de um arquivo <strong>.env</strong> (melhor segurança).</li>
<li>Estabelece conexão com o PostgreSQL utilizando credenciais seguras.</li>
<li>Lê e executa múltiplos comandos SQL de um arquivo <strong>.sql</strong>, garantindo que cada comando seja processado corretamente.</li>
<li>Confirma ou reverte as mudanças conforme necessário.</li>
<li>Exibe mensagens de status para facilitar o acompanhamento da execução.</li>
<li>Fecha a conexão com o banco de dados corretamente.</li>
</ol>
<p><strong>Justificativa técnica:</strong></p>
<ul>
<li>Utilizar <strong>dotenv</strong> evita expor credenciais no código, seguindo boas práticas de segurança.</li>
<li>Separar comandos SQL por <strong>;</strong> permite executar múltiplas instruções corretamente.</li>
<li>Mensagens de status ajudam no monitoramento e depuração do processo.</li>
<li>Uso de <strong>try-except-finally</strong> protege contra falhas, garantindo rollback em caso de erro.</li>
</ul>
<p><strong>Resultados esperados:</strong></p>
<ul>
<li>O banco de dados será atualizado com novas tabelas e estruturas conforme definidas no script SQL.</li>
<li>Caso ocorra um erro, a execução será interrompida com um rollback, preservando a integridade do banco.</li>
<li>Logs no console indicarão o andamento da execução para facilitar a depuração.</li>
</ul>
</font></div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python">#!pip install -q psycopg2
#!pip install -q dotenv</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Python - Pipeline de Criação do Banco de Dados
import psycopg2
import os
from dotenv import load_dotenv</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Versões dos pacotes usados neste jupyter notebook
%reload_ext watermark
%watermark -a "Roberto-SSoares-LfLngLrnng"</code></pre>
</div>
<div class="scrollable-output">
<pre>Author: Roberto-SSoares-LfLngLrnng

</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Carregar variáveis de ambiente do arquivo .env
load_dotenv('config-postgresql.env',override=True)</code></pre>
</div>
<div class="scrollable-output">
<pre>True</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python">def fn_executa_script_sql(filename):
    """Executa um script SQL no PostgreSQL a partir de um arquivo."""
    
    print("\nIniciando execução do script SQL...")

    # Conectar ao banco de dados PostgreSQL usando variáveis de ambiente
    # Use psycop2.connect() em conexões de uso rápido, como criar tabelas.
    # Para usos maiores como importar dados para tabela, o melhor é sqlalchemy.
    try:
        conn = psycopg2.connect(
            dbname=os.getenv("DB_NAME"),
            user=os.getenv("DB_USER"),
            password=os.getenv("DB_PASSWORD"),
            host=os.getenv("DB_HOST"),
            port=os.getenv("DB_PORT")
        )
        print("Conexão com o banco de dados estabelecida com sucesso.")
    except Exception as e:
        print(f"Erro ao conectar ao banco de dados: {e}")
        return

    cur = conn.cursor()

    # Ler e executar o conteúdo do arquivo SQL
    try:
        with open(filename, 'r', encoding='utf-8') as file:
            sql_script = file.read()

        # Separar os comandos SQL por `;` e executar um por um
        sql_commands = sql_script.strip().split(';')

        for command in sql_commands:
            if command.strip():  # Ignorar linhas vazias
                cur.execute(command)
        
        conn.commit()
        print("\n✅ Script executado com sucesso!\n")
    
    except Exception as e:
        conn.rollback()
        print(f"❌ Erro ao executar o script: {e}")

    finally:
        cur.close()
        conn.close()
        print("Conexão com o banco de dados fechada.")
</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Executar o script SQL
fn_executa_script_sql('ProjetoVarejo-01-Tabelas.sql')</code></pre>
</div>
<div class="scrollable-output">
<pre>
Iniciando execução do script SQL...
Conexão com o banco de dados estabelecida com sucesso.

✅ Script executado com sucesso!

Conexão com o banco de dados fechada.
</pre>
</div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<h2 id="Script-03-CarregaDados.py"><font color="#CC403E" face="Segoe Print" size="4"><strong>Script 03-CarregaDados.py</strong></font><a class="anchor-link" href="#Script-03-CarregaDados.py">¶</a></h2><font color="#66666" face="Segoe Print" size="2">
<p>Python e SQL - Pipeline de Carga de Dados</p>
<p><strong>Descrição do objetivo deste script:</strong></p>
<ul>
<li>O objetivo desta célula é carregar dados de múltiplos arquivos CSV para um banco de dados PostgreSQL, garantindo que os dados sejam inseridos nas tabelas corretas dentro do schema especificado.</li>
<li>Estabelecer uma conexão com o banco de dados PostgreSQL, usando credenciais armazenadas em um arquivo .env para não expor as informações sensíveis diretamente no código.</li>
<li>A célula também estabelece a conexão com o banco de dados utilizando SQLAlchemy, que facilita a integração do pandas com o PostgreSQL.</li>
</ul>
<p><strong>Ações realizadas no script:</strong></p>
<ol>
<li>Carregar as variáveis de ambiente usando a função load_dotenv() da biblioteca dotenv.</li>
<li>Construir a string de conexão com o banco de dados utilizando as credenciais carregadas das variáveis de ambiente.</li>
<li>Importação das bibliotecas necessárias para o trabalho com banco de dados (psycopg2, sqlalchemy) e manipulação de dados (pandas).</li>
<li>Estabelecimento de uma conexão com o banco de dados PostgreSQL usando o SQLAlchemy e a string de conexão fornecida.</li>
<li>Definição da função <strong>fn_carrega_dados</strong>, que recebe arquivos CSV e carrega os dados em uma tabela específica no banco de dados.</li>
<li>Uso do <strong>pandas.read_csv()</strong> para ler os dados do arquivo CSV.</li>
<li>A função <strong>to_sql</strong> do pandas é utilizada para enviar o dataframe para o banco de dados.<ul>
<li>O parâmetro <strong>'if_exists='append'</strong> assegura que os dados sejam adicionados à tabela existente sem sobrescrever os dados.</li>
</ul>
</li>
<li>A execução da função de carregamento de dados para múltiplos arquivos CSV e suas respectivas tabelas no banco de dados.</li>
</ol>
<p><strong>Justificativa técnica:</strong></p>
<ul>
<li>O uso de <strong>SQLAlchemy</strong> e <strong>pandas</strong> simplifica a interação entre Python e PostgreSQL, permitindo carregamento eficiente dos dados.</li>
<li>A função <strong>to_sql</strong> do pandas é ideal para carregar grandes volumes de dados de CSV para o banco de dados de forma automatizada.</li>
<li>A string de conexão do SQLAlchemy facilita a configuração da conexão com o banco de dados e a execução de operações.</li>
<li>A estratégia <strong>if_exists='append'</strong> garante que os dados sejam adicionados às tabelas sem afetar as tabelas já existentes no banco de dados.</li>
<li>O bloco <strong>try-except</strong> é usado para garantir que qualquer erro durante o processo de carga seja tratado de forma adequada e informada.</li>
</ul>
<p><strong>Resultados esperados:</strong></p>
<ul>
<li>Os dados de cada arquivo CSV serão carregados nas respectivas tabelas dentro do banco de dados PostgreSQL, com sucesso.</li>
<li>Caso ocorra algum erro durante a carga de dados (por exemplo, problemas de formato ou conexão), o erro será capturado e exibido.</li>
<li>O usuário será informado sobre o sucesso ou falha no processo de carga de dados, com feedback detalhado sobre cada arquivo.</li>
<li>Após o término da execução, o processo de análise de dados com IA será iniciado, como parte do pipeline de processamento.</li>
</ul>
</font></div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Projeto Varejo - IA Para Previsão de Demanda e Otimização do Estoque de Produtos Sazonais
# Imports
import psycopg2
import pandas as pd
import os
from dotenv import load_dotenv
from sqlalchemy import create_engine</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Versões dos pacotes usados neste jupyter notebook
%reload_ext watermark
%watermark -a "Roberto-SSoares-LfLngLrnng"</code></pre>
</div>
<div class="scrollable-output">
<pre>Author: Roberto-SSoares-LfLngLrnng

</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Carregar variáveis de ambiente do arquivo .env
load_dotenv('config-postgresql.env',override=True)</code></pre>
</div>
<div class="scrollable-output">
<pre>True</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Cria o motor de conexão (ATENÇÃO COM A STRING DE CONEXÃO ABAIXO!!!!!!) e conexão com as credenciais carregadas do arquivo .env
engine = create_engine(f'postgresql+psycopg2://{os.getenv("DB_USER")}:{os.getenv("DB_PASSWORD")}@{os.getenv("DB_HOST")}:{os.getenv("DB_PORT")}/{os.getenv("DB_NAME")}')

print("\nIniciando o Processo de Carga dos Dados!\n")</code></pre>
</div>
<div class="scrollable-output">
<pre>
Iniciando o Processo de Carga dos Dados!

</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Função para carregar dados dos arquivos CSV para o PostgreSQL no schema especificado
def fn_carrega_dados(csv_file, table_name, schema):
    # Bloco try/except para lidar com exceções durante o processo
    try:
        # Lê o arquivo CSV utilizando o pandas
        df = pd.read_csv(csv_file)

        # Carrega os dados do dataframe para a tabela do banco de dados
        df.to_sql(table_name, engine, schema=schema, if_exists='append', index=False)
        print(f"Dados do arquivo {csv_file} foram inseridos na tabela {schema}.{table_name}.")
    
    except Exception as e:
        print(f"Erro ao inserir dados do arquivo {csv_file} na tabela {schema}.{table_name}: {e}")</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Carregamento dos dados no schema 'projetoVarejo'
schema = 'projetovarejo'

fn_carrega_dados('tb_fornecedores.csv', 'fornecedores', schema)
fn_carrega_dados('tb_categorias.csv', 'categorias', schema)
fn_carrega_dados('tb_produtos.csv', 'produtos', schema)
fn_carrega_dados('tb_clientes.csv', 'clientes', schema)
fn_carrega_dados('tb_vendas.csv', 'vendas', schema)
fn_carrega_dados('tb_estoque.csv', 'estoque', schema)
fn_carrega_dados('tb_sazonalidade.csv', 'sazonalidade', schema)
fn_carrega_dados('tb_forecast.csv', 'forecast', schema)
fn_carrega_dados('tb_reabastecimento.csv', 'reabastecimento', schema)
fn_carrega_dados('tb_pedidos.csv', 'pedidos', schema)

print("\nCarga Executada com Sucesso! Use o pgAdmin Para Checar os Dados Se Desejar!\n")
print("\nIniciando o Processo de Análise dos Dados com IA. Seja Paciente e Aguarde o Excelente Resultado Que Será Entregue a Você!\n")</code></pre>
</div>
<div class="scrollable-output">
<pre>Dados do arquivo tb_fornecedores.csv foram inseridos na tabela projetovarejo.fornecedores.
Dados do arquivo tb_categorias.csv foram inseridos na tabela projetovarejo.categorias.
Dados do arquivo tb_produtos.csv foram inseridos na tabela projetovarejo.produtos.
Dados do arquivo tb_clientes.csv foram inseridos na tabela projetovarejo.clientes.
Dados do arquivo tb_vendas.csv foram inseridos na tabela projetovarejo.vendas.
Dados do arquivo tb_estoque.csv foram inseridos na tabela projetovarejo.estoque.
Dados do arquivo tb_sazonalidade.csv foram inseridos na tabela projetovarejo.sazonalidade.
Dados do arquivo tb_forecast.csv foram inseridos na tabela projetovarejo.forecast.
Dados do arquivo tb_reabastecimento.csv foram inseridos na tabela projetovarejo.reabastecimento.
Dados do arquivo tb_pedidos.csv foram inseridos na tabela projetovarejo.pedidos.

Carga Executada com Sucesso! Use o pgAdmin Para Checar os Dados Se Desejar!


Iniciando o Processo de Análise dos Dados com IA. Seja Paciente e Aguarde o Excelente Resultado Que Será Entregue a Você!

</pre>
</div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<h2 id="Script-04-LLM.py"><font color="#CC403E" face="Segoe Print" size="4"><strong>Script 04-LLM.py</strong></font><a class="anchor-link" href="#Script-04-LLM.py">¶</a></h2><font color="#66666" face="Segoe Print" size="2">
<p>Python - Pipeline de Extração de Insights com LLM</p>
<p><strong>Descrição do objetivo da célula:</strong></p>
<ul>
<li>Esta célula tem como objetivo extrair insights sobre demanda e estoque de produtos sazonais, utilizando um modelo de linguagem natural (LLM) para gerar<br/>análises automatizadas com base nos dados de vendas, estoque e previsões armazenados em um banco PostgreSQL.</li>
</ul>
<p><strong>Ações realizadas na célula:</strong></p>
<ol>
<li>Importa as bibliotecas necessárias (csv, psycopg2, langchain).</li>
<li>Instancia o modelo de linguagem (Llama3 via Ollama) e configura um parser para processar sua saída.</li>
<li>Conecta-se ao banco de dados PostgreSQL e executa uma query SQL para coletar dados de produtos, vendas, estoque, sazonalidade e previsões de demanda.</li>
<li>Formata os dados obtidos e cria um prompt para o LLM analisar cada produto.</li>
<li>O LLM gera insights baseados nas informações coletadas, que são armazenados em uma lista.</li>
<li>Salva os insights gerados em um arquivo CSV para análise posterior.</li>
<li>Exibe os insights gerados no console.</li>
</ol>
<p><strong>Justificativa técnica:</strong></p>
<ul>
<li>O uso de um banco de dados PostgreSQL permite armazenar e consultar grandes volumes de dados estruturados de forma eficiente.</li>
<li>A consulta SQL é projetada para combinar diferentes fontes de dados (vendas, estoque, previsão de demanda, etc.), garantindo uma visão holística da situação de cada produto.</li>
<li>A utilização de um LLM como o Llama3 automatiza a análise dos dados, permitindo extrair padrões e recomendações sem necessidade de scripts manuais complexos.</li>
<li>A exportação para CSV permite compartilhar e visualizar os insights facilmente, possibilitando integração com outras ferramentas analíticas.</li>
</ul>
<p><strong>Resultados esperados:</strong></p>
<ul>
<li>Geração automática de insights sobre a demanda e o estoque dos produtos sazonais.</li>
<li>Identificação de possíveis problemas, como excesso ou falta de estoque, permitindo tomada de decisão baseada em dados.</li>
<li>Exportação dos insights para um arquivo CSV, facilitando sua análise e compartilhamento.</li>
<li>Exibição dos insights diretamente no console para uma rápida visualização e validação dos resultados.</li>
</ul>
</font></div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Projeto Varejo - IA Para Previsão de Demanda e Otimização do Estoque de Produtos Sazonais
# Python - Pipeline de Extração de Insights com LLM

# Imports
import csv
import psycopg2
import os
from dotenv import load_dotenv
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser
#from langchain_community.llms.ollama import Ollama  # Antigo
from langchain_ollama import OllamaLLM</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Versões dos pacotes usados neste jupyter notebook
%reload_ext watermark
%watermark -a "Roberto-SSoares-LfLngLrnng"</code></pre>
</div>
<div class="scrollable-output">
<pre>Author: Roberto-SSoares-LfLngLrnng

</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Carregar variáveis de ambiente do arquivo .env
load_dotenv('config-postgresql.env',override=True)</code></pre>
</div>
<div class="scrollable-output">
<pre>True</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Instanciação do LLM Llama3 através do Ollama
#llm = Ollama(model = "llama3") # Antigo
llm = OllamaLLM(model="llama3")</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Criação do parser para a saída do modelo de linguagem
output_parser = StrOutputParser()</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Define a consulta SQL para obter dados dos clientes, compras e produtos

# Lista de categorias
categoria = ['Eletrônicos', 'Roupas']

# Criar placeholders dinâmicos para a lista
placeholders = ', '.join(['%s'] * len(categoria))

# Query com placeholders
sql_query = f"""
            SELECT
                p.id_produto AS id_produto,
                p.nome_produto AS nome_produto,
                c.nome_categoria AS nome_categoria,
                f.nome_fornecedor AS nome_fornecedor,
                COALESCE(SUM(v.quantidade_vendida), 0) AS total_vendido,
                COALESCE(e.quantidade_em_estoque, 0) AS quantidade_em_estoque,
                COALESCE(s.nome_temporada, 'Nenhuma') AS temporada,
                COALESCE(fore.quantidade_forecast, 0) AS quantidade_forecast,
                COALESCE(re.quantidade, 0) AS quantidade_reabastecida
            FROM
                projetoVarejo.produtos p
            LEFT JOIN
                projetoVarejo.categorias c ON p.id_categoria = c.id_categoria
            LEFT JOIN
                projetoVarejo.fornecedores f ON p.id_fornecedor = f.id_fornecedor
            LEFT JOIN
                projetoVarejo.vendas v ON p.id_produto = v.id_produto
            LEFT JOIN
                projetoVarejo.estoque e ON p.id_produto = e.id_produto
            LEFT JOIN
                projetoVarejo.sazonalidade s ON p.id_produto = s.id_produto
            LEFT JOIN
                projetoVarejo.forecast fore ON p.id_produto = fore.id_produto
            LEFT JOIN
                projetoVarejo.reabastecimento re ON p.id_produto = re.id_produto
            WHERE
                c.nome_categoria IN ({placeholders})
            GROUP BY
                p.id_produto, p.nome_produto, c.nome_categoria, f.nome_fornecedor,
                e.quantidade_em_estoque, e.data_ultimo_reabastecimento,
                s.nome_temporada, s.data_inicio, s.data_fim,
                fore.quantidade_forecast, re.quantidade, re.data_reabastecimento
            ORDER BY
                p.id_produto;
        """</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python">import psycopg2

# Lista de categorias
categoria = ['Eletrônicos', 'Roupas']

# Conectar ao banco
# Conecta ao banco de dados PostgreSQL com as credenciais fornecidas
conn = psycopg2.connect(
        dbname=os.getenv("DB_NAME"),
        user=os.getenv("DB_USER"),
        password=os.getenv("DB_PASSWORD"),
        host=os.getenv("DB_HOST"),
        port=os.getenv("DB_PORT")
    )

cur = conn.cursor()

# Criar placeholders dinâmicos para a lista
placeholders = ', '.join(['%s'] * len(categoria))

# Query com placeholders
query = sql_query

# Executar a query passando os valores da lista
cur.execute(query, categoria)

# Obter os resultados
resultados = cur.fetchall()

# Fechar conexão
cur.close()
conn.close()

# Exibir resultados
print(resultados)
</code></pre>
</div>
<div class="scrollable-output">
<pre>[(1, 'Smartphone', 'Eletrônicos', 'Fornecedor A', 3, 50, 'Dia das Mães', 50, 50), (2, 'Laptop', 'Eletrônicos', 'Fornecedor A', 3, 30, 'Nenhuma', 30, 30), (3, 'TV 55"', 'Eletrônicos', 'Fornecedor B', 3, 20, 'Nenhuma', 20, 20), (4, 'Caixa de Som Bluetooth', 'Eletrônicos', 'Fornecedor C', 5, 100, 'Nenhuma', 100, 100), (5, 'Tablet', 'Eletrônicos', 'Fornecedor D', 3, 40, 'Nenhuma', 40, 40), (11, 'Camisa Polo', 'Roupas', 'Fornecedor A', 5, 70, 'Nenhuma', 70, 0), (12, 'Calça Jeans', 'Roupas', 'Fornecedor B', 2, 60, 'Nenhuma', 60, 0), (13, 'Tênis Esportivo', 'Roupas', 'Fornecedor C', 2, 90, 'Nenhuma', 90, 0), (14, 'Jaqueta de Couro', 'Roupas', 'Fornecedor D', 3, 80, 'Nenhuma', 80, 0), (15, 'Meias 3 pares', 'Roupas', 'Fornecedor E', 9, 130, 'Dia dos Pais', 130, 0)]
</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Função para gerar texto baseado nos dados do PostgreSQL
def fn_gera_insights():

    # Conecta ao banco de dados PostgreSQL com as credenciais fornecidas
    conn = psycopg2.connect(
        dbname=os.getenv("DB_NAME"),
        user=os.getenv("DB_USER"),
        password=os.getenv("DB_PASSWORD"),
        host=os.getenv("DB_HOST"),
        port=os.getenv("DB_PORT")
    )

    # Cria um cursor para executar comandos SQL
    cursor = conn.cursor()
    
    # Define a consulta SQL para obter dados dos clientes, compras e produtos
    query = sql_query
    
    # Executa a consulta SQL
    #cursor.execute(query)
    cursor.execute(query, categoria)


    # Obtém todos os resultados da consulta
    rows = cursor.fetchall()
    
    # Inicializa uma lista para armazenar os insights
    insights = []

    # Criação do template de prompt para o chatbot 
    prompt = ChatPromptTemplate.from_messages(
        [
            ("system", "Você é um cientista de dados especializado. Analise os dados e forneça feedback em português do Brasil sobre previsão de demanda e otimização do estoque de produtos sazonais."),
            ("user", "question: {question}")
        ]
    )

    # Definição da cadeia de execução: prompt -&gt; LLM -&gt; output_parser
    chain = prompt | llm | output_parser

    # Itera sobre as linhas de resultados
    for row in rows:
        
        # Desempacota os valores de cada linha
        id_produto, nome_produto, nome_categoria, nome_fornecedor, total_vendido, quantidade_em_estoque, temporada, quantidade_forecast, quantidade_reabastecida = row
        
        # Cria o prompt para o LLM com base nos dados do cliente
        consulta = f"ID_Produto {id_produto} Nome_Produto {nome_produto} Nome_Categoria {nome_categoria} Nome_Fornecedor {nome_fornecedor} Total_Vendido ${total_vendido:.2f} quantidade_em_estoque {quantidade_em_estoque:.2f} temporada {temporada} quantidade_forecast {quantidade_forecast} quantidade_reabastecida {quantidade_reabastecida}."
        
        # Gera o texto de insight usando o LLM
        response = chain.invoke({'question': consulta})
        
        # Adiciona o texto gerado à lista de insights
        insights.append(response)
    
    # Fecha a conexão com o banco de dados
    conn.close()

    # Salva os insights em um arquivo CSV
    with open('projetoVarejo-analise.csv', mode='w', newline='', encoding='utf-8') as file:
        writer = csv.writer(file)
        writer.writerow(["Insight"])
        for insight in insights:
            writer.writerow([insight])

    # Retorna a lista de insights
    return insights</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Gera insights chamando a função definida
insights = fn_gera_insights()</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Imprime cada insight gerado
for insight in insights:
    print(insight)</code></pre>
</div>
<div class="scrollable-output">
<pre>Análise dos dados:

O produto "Smartphone" da categoria "Eletrônicos" do fornecedor "A" apresenta uma demanda significativa, especialmente durante a temporada de "Dia das Mães". A média histórica de vendas é de $3.00 por unidade, com uma quantidade total vendida de 50 unidades.

Análise da temporada:

* A temporada de "Dia das Mães" é um período crítico para a venda de produtos sazonais, como o Smartphone.
* A quantidade total de vendas registra uma alta durante essa temporada, com $15.00 (três vezes a média histórica) vendidas em apenas 10 unidades.

Recomendação:

* Para atender à demanda crescente da temporada e minimizar a possibilidade de falta de estoque, é recomendável reabastecer o estoque com 30 novas unidades adicionais.
* A quantidade_reabastecida deve ser igual a quantidade_forecast (50), para garantir que haja suficiente estoque disponível durante a temporada.

Feedback:

A previsão da demanda do produto "Smartphone" durante a temporada de "Dia das Mães" é positiva, com uma alta demanda prevista. Para atender à essa demanda e minimizar o risco de falta de estoque, recomendo reabastecer o estoque com 30 novas unidades adicionais.

Estatísticas:

* Média histórica de vendas: $3.00 por unidade
* Total de vendas durante a temporada: $15.00 (três vezes a média histórica)
* Quantidade total em estoque: 50.00
* Quantidade forecast para a temporada: 50
* Recomendação para reabastecimento: 30 unidades adicionais
Análise de dados!

Vou analisar os dados para fornecer feedback sobre a previsão da demanda e otimização do estoque do produto "Laptop" pertencente à categoria "Eletrônicos".

**Análise dos dados**

* **Quantidade vendida (Total_Vendido)**: $3.00, o que indica uma demanda baixa para esse produto.
* **Quantidade em estoque (quantidade_em_estoque)**: 30 unidades, que parece ser um nível de estoque razoável para um produto sazonal.
* **Previsão da quantidade demandada (quantidade_forecast)**: 30 unidades, o que é igual à quantidade atual em estoque. Isso sugere que a previsão da demanda não está considerando variações sazonais ou seasonales.
* **Quantidade reabastecida (quantidade_reabastecida)**: 30 unidades, o que coincide com a quantidade em estoque e a previsão da demanda.

**Feedback**

1. **Previsão de demanda**: A previsão da demanda parece não considerar variações sazonais ou seasonales. É importante atualizar a previsão para refletir as mudanças na demanda ao longo do tempo.
2. **Otimização do estoque**: Com uma quantidade em estoque razoável e uma previsão da demanda que não considera variações sazonais, é recomendado ajustar o estoque para atender às necessidades futuras.
3. **Estratégias de reabastecimento**: Para evitar problemas de estoque baixo ou excessivo, é necessário estabelecer um sistema de reabastecimento mais eficaz, levando em conta as mudanças na demanda e a previsão da quantidade demandada.

**Recomendações**

1. Atualize a previsão da demanda para considerar variações sazonais ou seasonales.
2. Ajuste o estoque para atender às necessidades futuras, tendo em conta a previsão da demanda atualizada.
3. Estabeleça um sistema de reabastecimento mais eficaz, levando em conta as mudanças na demanda e a previsão da quantidade demandada.

Espero que essas recomendações sejam úteis para sua análise!
Análise de Dados: ID_Produto 3 - TV 55"

**Resumo**: O produto em questão é uma TV 55" pertencente à categoria de Eletrônicos, fornecido pelo Fornecedor A. Com base nos dados históricos, podemos verificar que a quantidade vendida até o momento (Total_Vendido) é de $3.00 e a quantidade atualmente em estoque (quantidade_em_estoque) é de 20 unidades.

**Análise da Sazonalidade**: O campo "temporada" indica que não há uma temporada específica associada ao produto, o que sugere que sua demanda pode ser mais estável ao longo do tempo. No entanto, é sempre importante considerar os dados históricos e tendências para identificar possíveis flutuações na demanda.

**Previsão de Demanda**: Com base nos dados históricos, podemos fazer uma previsão da quantidade que será vendida no futuro próximo. A quantidade_forecast (20) é igual à quantidade atualmente em estoque, o que sugere que a demanda está equilibrada com o estoque.

**Otimização do Estoques**: Com a previsão de demanda estabelecida, podemos avaliar se o estoque atual é suficiente para atender às necessidades futuras. Na presente situação, a quantidade_em_estoque (20) é igual à quantidade_forecast (20), o que sugere que o estoque está bem dimensionado e não há necessidade de reabastecimento imediato.

**Recursos**: Como cientista de dados, eu recomendo realizar uma análise mais detalhada dos dados históricos para identificar padrões e tendências na demanda do produto. Além disso, é importante monitorar os dados em tempo real para detectar qualquer mudança na demanda ou no mercado.

**Recomendações**:

1. Monitorize atentamente a demanda do produto e ajuste o estoque caso seja necessário.
2. Considere realizar uma análise de temporada para identificar possíveis flutuações na demanda em função da estação do ano.
3. Analise as tendências da demanda para prever se há um crescimento ou declínio futuro.

Essas são minhas recomendações com base nos dados fornecidos. Caso você precise de mais ajuda, sinta-se à vontade para fornecer mais informações!
Excelente dados para análise!

A partir dos dados, posso dizer que o produto "Caixa de Som Bluetooth" pertence à categoria Eletrônicos e é fornecido pela empresa Fornecedor C.

Aqui estão minhas observações e recomendações:

**Análise da demanda**: A média de vendas por temporada é de $5.00, com uma quantidade total vendida de 100 unidades. Isso indica que a demanda por este produto é moderada e estável ao longo do tempo.

**Otimização do estoque**: Com um estoque atualizado em 100 unidades, posso dizer que você tem um nível de segurança adequado para atender à demanda projetada. Além disso, a quantidade forecasted (quantidade_forecast) é igual ao estoque atual, o que significa que não há necessidade de reabastecer imediatamente.

**Recomendações**: Para otimizar o estoque e reduzir possíveis perdas ou gastos desnecessários, sugiro que você considere implementar uma política de just-in-time (JIT) para este produto. Isso significa que, ao invés de reabastecer todo o estoque de uma vez, você pode reabastecer apenas a quantidade necessária para atender à demanda projetada.

**Risco de falta**: Embora o estoque atual seja suficiente para atender à demanda, é importante notar que um nível mais baixo de estoque (cerca de 50-70% do atual) pode ser considerado uma opção viável. Isso permitiria que você reabastece apenas a quantidade necessária e reduza o risco de falta de estoque.

**Recomendações finais**: Em resumo, recomendo que você mantenha um estoque razoável (cerca de 100 unidades) e considere implementar uma política de JIT para este produto. Além disso, é importante monitorar a demanda e ajustar o estoque com base nos resultados.

Espero que essas sugestões sejam úteis!
Análise dos dados!

Vamos começar com o ID do produto, que é o 5. O nome do produto é Tablet, e ele pertence à categoria de Eletrônicos.

Agora, vamos analisar a demanda histórica do produto. Com base nos dados, vemos que a quantidade vendida foi de $3.00 por unidade, com um total de unidades vendidas igual a 40. Além disso, há atualmente 40 unidades em estoque.

A temporada do produto é classificada como "Nenhuma", o que significa que não há uma temporada específica associada ao produto (provavelmente porque ele é um produto não sazonal).

Vamos fazer uma previsão de demanda com base na história de vendas do produto. Com um estoque atual de 40 unidades e considerando a média móvel de 40 unidades vendidas por período, podemos estimar que a demanda futura seja igual à quantidade em estoque.

Portanto, minha recomendação é manter o estoque atual de 40 unidades, pois a previsão de demanda indica que não há necessidade de reabastecer ou reduzir o estoque. Além disso, com um estoque razoável e uma demanda estável, podemos evitar os custos associados à gestão do estoque (como os custos de armazenamento e possíveis perdas por descarte).

No entanto, é importante continuar monitorando a demanda e as vendas para garantir que a previsão esteja correta. Caso a demanda seja maior ou menor do que o esperado, precisaremos reavaliar a estratégia de estoque e ajustá-la se necessário.

Essa é minha análise inicial com base nos dados fornecidos. Se você tiver mais informações ou quer que eu faça uma análise mais detalhada, sinta-se à vontade para perguntar!
Análise de dados para o produto "Camisa Polo"!

**Previsão de demanda:**

A previsão de demanda para este produto é relativamente estável, com uma média de $5,00 por unidade vendida e uma quantidade total vendida de 70 unidades. Com base nessa informação, não há motivos para se preocupar com a demanda futura.

**Análise da temporada:**

O registro da temporada como "Nenhuma" sugere que o produto não está relacionado a uma temporada específica (verão, outono, inverno ou primavera). Isso significa que a demanda pode variar ao longo do ano devido a fatores como mudanças climáticas, estilos de moda e eventos esportivos.

**Otimização do estoque:**

Considerando que o estoque atual é de 70 unidades e não há uma temporada específica associada ao produto, eu recomendo manter um estoque razoável de aproximadamente 50-60 unidades. Isso permitirá atender à demanda mais baixa prevista, sem comprometer a capacidade de reabastecer o estoque quando necessário.

**Recomendações:**

1. Monitorize a demanda e ajuste o estoque periodicamente para garantir que esteja adequado às necessidades do mercado.
2. Considerar implementar um sistema de alertas para detectar mudanças na demanda e reabastecer o estoque quando necessário.
3. Analise as tendências de vendas ao longo do tempo para identificar oportunidades de crescimento ou ajustes no estoque.

Em resumo, a previsão de demanda para o produto "Camisa Polo" é estável, e a otimização do estoque deve se concentrar em manter um nível razoável de unidades, permitindo reabastecer quando necessário.
Análise de dados para previsão de demanda e otimização do estoque de produtos sazonais.

**Análise da temporada**

A análise dos dados indica que o produto "Calça Jeans" não está associado a uma temporada específica, o que significa que sua demanda é constante ao longo do ano. No entanto, é importante notar que as vendas podem variar de acordo com fatores como época do ano, campanhas publicitárias e mudanças no mercado.

**Análise dos dados históricos**

A análise dos dados históricos de venda (Total_Vendido) indica uma tendência de venda estável ao longo do tempo. A média das vendas é de $2,00 por unidade. A quantidade em estoque atualmente é de 60 unidades.

**Previsão de demanda**

Considerando a tendência histórica de venda e a falta de temporada específica para o produto, podemos fazer uma previsão conservadora da demanda futura. Como a média das vendas é de $2,00 por unidade, podemos estabelecer uma previsão de demanda baseada na média das vendas históricas.

Previsão de demanda: 60 unidades (quantidade em estoque atual)

**Recomendação**

Considerando a previsão de demanda e a quantidade em estoque atual, não é necessário reabastecer o estoque imediatamente. No entanto, é importante monitorar as vendas ao longo do tempo e ajustar a estratégia de estoque de acordo com as variações da demanda.

**Sugestão**

Para otimizar o estoque, sugiro que você considere implementar um sistema de alerta para quando a quantidade em estoque cair abaixo de um nível determinado (por exemplo, 30 unidades). Isso permitirá que você tome medidas preventivas e reabasteça o estoque antes de esgotá-lo.

Além disso, é importante monitorar as variações da demanda ao longo do tempo e ajustar a estratégia de estoque de acordo com essas variações. Isso pode incluir reabastecimento do estoque ou mudanças na política de preços para manter o nível de vendas estável.

Espero que essa análise ajude você a melhorar sua estratégia de estoque e previsão de demanda para o produto "Calça Jeans".
Olá!

Analisando os dados, posso fornecer o seguinte feedback:

**Análise da demanda**

O produto "Tênis Esportivo" tem uma quantidade total vendida de US$ 2.00 e uma quantidade em estoque atual de 90 unidades. A temporada não é definida como sazonal, o que sugere que a demanda possa ser mais estável ao longo do tempo.

No entanto, para melhor entender a tendência da demanda, é necessário analisar os dados históricos e identificar padrões de comportamento dos clientes. Além disso, é importante considerar a estação do ano e as datas específicas que podem afetar a demanda (por exemplo, datas de lançamentos de produtos ou eventos esportivos).

**Previsão de demanda**

Com base nos dados históricos e tendências, posso fazer uma previsão inicial da demanda para o próximo trimestre. Considerando a temporada não ser definida como sazonal, a previsão é mais conservadora.

Previsão: quantidade_total_vendida = US$ 2.20
quantidade_em_estoque = 100

**Otimização do estoque**

Com base na previsão da demanda, posso sugerir que o estoque atual de 90 unidades está razoavelmente adequado para atender à demanda projetada. No entanto, é importante monitorar a evolução da demanda e ajustar o estoque com base em novas informações.

**Recomendações**

Para melhorar a gestão do estoque:

1. Monitorize a evolução da demanda e ajuste o estoque diariamente.
2. Considere definir uma temporada para o produto "Tênis Esportivo" se houver evidências de que a demanda seja mais sazonal.
3. Análise os dados históricos para identificar padrões de comportamento dos clientes e ajuste a previsão da demanda com base nisso.

Essas são minhas sugestões inicialmente. Se você tiver mais informações ou dados adicionais, posso fornecer um feedback mais específico e detalhado.
Análise dos dados:

* O produto em questão é a Jaqueta de Couro (ID_Produto: 14), que pertence à categoria Roupas.
* A quantidade total vendida do produto até o momento é de $3,00.
* A quantidade atualmente em estoque é de 80 unidades.
* Não há temporada específica mencionada para esse produto, o que sugere que ele não seja um item sazonal.
* A previsão de quantidade a ser vendida no futuro (quantidade_forecast) é igual à quantidade atual em estoque (80).
* A quantidade reabastecida no passado foi zero.

Feedback:

Em geral, os dados sugerem que o estoque da Jaqueta de Couro está bem gerenciado e não há motivos para preocupação em relação ao estoque atual. No entanto, é importante considerar alguns fatores antes de tomar uma decisão sobre a gestão do estoque.

* Como o produto não tem temporada específica, pode ser que ele seja vendido uniformemente ao longo do ano.
* A previsão de quantidade a ser vendida no futuro é igual à quantidade atual em estoque. Isso significa que, se as vendas continuarem uniformes, não há necessidade de reabastecer o estoque.
* No entanto, é importante considerar a possibilidade de picos sazonais ou surtos de demanda inesperados. Se houver uma mudança nas condições do mercado ou na tendência das vendas, pode ser necessário ajustar a gestão do estoque para evitar perdas de oportunidade ou excesso de estoque.

Recomendação:

* Continue monitorando as vendas e previsões para identificar qualquer tendência ou padrão que possa afetar o estoque.
* Ajuste a gestão do estoque de acordo com as necessidades, levando em conta as tendências das vendas e a disponibilidade financeira.

 Não há necessidade imediata de reabastecer o estoque da Jaqueta de Couro. Continue monitorando os dados e ajustar a gestão do estoque como necessário.
Análise de dados:

**Resumo**: O produto "Meias" (ID_Produto: 15) pertence à categoria "Roupas" e é fornecido pelo Fornecedor E. A quantidade total vendida até o momento é de $9,00 com 130 unidades em estoque.

**Análise da temporada**: Com a proximidade do Dia dos Pais (quantidade_forecast: 130), parece que a demanda por esse produto irá aumentar. É importante otimizar o estoque para atender à expectativa de vendas e evitar perdas por falta de produtos.

**Sugestão**: Considerando que a quantidade forecast é igual à quantidade atual em estoque, sugiro reabastecer com 0 unidades (quantidade_reabastecida: 0) para evitar excesso de estoque e reduzir custos. Isso permitirá atender às demandas do Dia dos Pais e minimizar o risco de perda por falta de produtos.

**Observação**: É fundamental monitorar as vendas e ajustar a estratégia de reabastecimento em tempo real para evitar problemas de estoque. Além disso, é recomendável que você execute uma análise mais aprofundada das tendências de demanda e do histórico de vendas para melhorar a previsão da demanda e otimizar o estoque de forma mais eficaz.

**Conclusão**: Com base nos dados, sugiro reabastecer com 0 unidades para atender às demandas do Dia dos Pais e minimizar o risco de perda por falta de produtos. É importante monitorar as vendas e ajustar a estratégia de reabastecimento em tempo real para garantir um estoque otimizado e reduzir custos.
</pre>
</div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<h2 id="Script-05-Run-Pipeline.py"><font color="#CC403E" face="Segoe Print" size="4"><strong>Script 05-Run-Pipeline.py</strong></font><a class="anchor-link" href="#Script-05-Run-Pipeline.py">¶</a></h2><font color="#66666" face="Segoe Print" size="2">
<p><strong>Python - Executa o Pipeline</strong></p>
</font></div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Imports
import subprocess</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Versões dos pacotes usados neste jupyter notebook
%reload_ext watermark
%watermark -a "Roberto-SSoares-LfLngLrnng"</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Projeto 7 - IA Para Previsão de Demanda e Otimização do Estoque de Produtos Sazonais
# Função para executar outros scripts Python
def fn_run_pipeline(script_name):
    try:
        result = subprocess.run(['python', script_name], check=True, capture_output=True, text=True)
        print(f"\nScript {script_name} executado com sucesso.")
        print("\nSaída:\n", result.stdout)
    except subprocess.CalledProcessError as e:
        print(f"\nErro ao executar o script {script_name}.")
        print("\nErro:\n", e.stderr)

# Lista de scripts
scripts = [
    'ProjetoVarejo-02-CriaTabelas.py',
    'ProjetoVarejo-03-CarregaDados.py',
    'ProjetoVarejo-04-LLM.py'
]</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"># Executa os scripts em um loop
for script in scripts:
    fn_run_pipeline(script)

print(f"\nPipeline executado com sucesso.\n")</code></pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python">%reload_ext watermark
%watermark -a "Roberto-SSoares-LfLngLrnng"</code></pre>
</div>
<div class="scrollable-output">
<pre>Author: Roberto-SSoares-LfLngLrnng

</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python">%watermark -v -m</code></pre>
</div>
<div class="scrollable-output">
<pre>Python implementation: CPython
Python version       : 3.10.15
IPython version      : 8.27.0

Compiler    : MSC v.1929 64 bit (AMD64)
OS          : Windows
Release     : 10
Machine     : AMD64
Processor   : Intel64 Family 6 Model 158 Stepping 9, GenuineIntel
CPU cores   : 4
Architecture: 64bit

</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python">%watermark --iversions</code></pre>
</div>
<div class="scrollable-output">
<pre>langchain_core  : 0.3.33
langchain_ollama: 0.2.3
psycopg2        : 2.9.10
sqlalchemy      : 2.0.37
csv             : 1.0
pandas          : 2.2.3

</pre>
</div>
</div>
<div class="cell">
<!-- Renderiza Markdown, e inclui suporte para imagens -->
<div class="markdown">
<div style="background-color:#F3F2EE">
<p><font color="#CC403E" face="Segoe Print" size="5"><strong>Fim</strong></font></p>
<font color="#66666" face="Segoe Print" size="3">
</font></div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python">!jupyter nbconvert --to html --template=D:/anaconda3/envs/spark-pod-env/share/jupyter/nbconvert/templates/compatibility/mytemplate_a.tpl BA-DS-ML-Retail-Area.ipynb</code></pre>
</div>
<div class="scrollable-output">
<pre>[NbConvertApp] Converting notebook BA-DS-ML-Retail-Area.ipynb to html
[NbConvertApp] Writing 71739 bytes to BA-DS-ML-Retail-Area.html
</pre>
</div>
</div>
<div class="cell">
<div class="code_cell">
<pre><code class="python"></code></pre>
</div>
</div>
<script>
        // Reprocessa o MathJax após a página ser carregada
        document.addEventListener("DOMContentLoaded", function() {
            MathJax.typesetPromise();
        });
    </script>
</div></div></div></div></div></div></div></div></div></body>
</html>